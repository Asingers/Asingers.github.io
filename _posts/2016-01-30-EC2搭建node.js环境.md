---
layout: post
title: "AWS EC2搭建node.js环境"
subtitle: "日常搞机,你或许需要"
date: 2016-01-30 11:20:20
author: "Asingers"
header-img: "img/sucai_sample-image-1.jpg"
tags:
    - AWS
    - EC2
    - VPN
---

**1，为什么用EC2搭建node.js环境。**

首先，本地虚拟机装centOs是很好的选择，但是需要在家里和公司同时搭好相同的环境比较麻烦，而且也不方便小团队一起折腾。


亚马逊的免费虚拟机只要不跑太复杂的运算大概不会有额外的费用，而且亚马逊么有被墙，国内的托管目前cnode的邀请号求不到啊，还是自己动手丰衣足食吧。

**2，如何申请免费一年的EC2**

在http://aws.amazon.com/上注册。


网上有很多教程，请自行GOOGLE。


**3，EC2虚拟机简单的管理和设置**


新建KEY，保存。


For MAC & Linux


很简单，只要一句话




    ssh -i user.pem ec2-user[@ec2-XXX-XXX-XXX-XXX](/user/ec2-XXX-XXX-XXX-XXX).compute-1.amazonaws.com





以上user.pem可以是你的KEY的路径。


For PC


putty[链接ec2-XXX-XXX-XXX-XXX.compute-1.amazonaws.com](http://xn--ec2-XXX-XXX-XXX-XXX-pn82b1534d.compute-1.amazonaws.com)


注意需要在connection->SSH->Auth里选上你的KEY，之前需要转pem到ppk。


怎么看DNS名：在管理界面里，先点击你要查看的虚拟机，点右键，再弹出的菜单上点“connect”就可以看到如下图：


其中ec2-XXX-XXX-XXX-XXX.compute-1.amazonaws.com是你的DNS名


一般不太需要调整什么，可能要改的就是端口8080要开启。


**4，搭建node前的准备**


默认的liunx中不会吧所有工具都装好，一些基本的工具，需要我们自己装。

以下：

a.make

b.gcc++


c.curl


d.git


一句话安装：




    sudo yum install gcc-c++ openssl-devel make curl git




**5，安装node**



    wget[http://nodejs.org/dist/node-v0.4.12.tar.gz](http://nodejs.org/dist/node-v0.4.12.tar.gz)
    tar -xvf node-v0.4.12.tar.gz
    cd node-v0.4.12
    ./configure
    make





由于是在云里跑的，所以make可能会花上30多分钟， 我出去吃了个中饭，回办公室发现好了的。所以，不用在屏幕前傻等，出去走走，预防一下颈椎病。




    make install





其他调整，由于EC2中path的问题，node装完了不一定能直接跑。所以有时候需要做些映射。




    sudo ln -s /usr/local/bin/node /usr/bin/node
    sudo ln -s /usr/local/lib/node /usr/lib/node
    sudo ln -s /usr/local/bin/npm /usr/bin/npm
    sudo ln -s /usr/local/bin/node-waf /usr/bin/node-waf



### 安装npm: 
	sudo yum install nodejs npm --enablerepo=epel
	
**6，测试第一个静态文件服务**


先在/home/ec2-user/上建个nodeweb目录，里面放静态页面，然后可以测试了～～

另外:

LINUX VPS没有ROOT权限是很难受的事，并且密码登陆也方便一些。
我的AWS VPS的LINUX版本是UBUNTU 13.10，首先用AWS证书验证的账户登录，


1、修改ROOT密码
sudo passwd root


2、sudo chmod 777 /etc/ssh/sshd_config
用完再把权限改回来


3、vi /etc/ssh/sshd_config
PermitRootLogin
这行改为
PermitRootLogin yes
PasswordAuthentication no
上面的no改为yes
UsePAM yes
上面的yes改为no


4、重启AWS VPS，就可以使用root正常登陆了