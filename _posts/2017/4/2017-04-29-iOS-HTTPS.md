---
layout: post
title: HTTPS åˆ°åº•ä»–å¨˜çš„æ˜¯ä»€ä¹ˆç©æ„?
subtitle: ğŸ”
header-img: https://ws1.sinaimg.cn/large/006tNc79ly1fip274xvm6j30xc0p07a0.jpg
categories: ios
header-mask: 0.6
tags: 
    - iOS

---

æˆ‘ä»¬éƒ½çŸ¥é“ Apple åœ¨ä¸¥æ ¼è¦æ±‚ HTTPS ä¼ è¾“ä¹‹å.ç°åœ¨ APP è®¾è®¡ä¹‹åˆéƒ½å·²ç»å°† HTTPS è€ƒè™‘åœ¨å†….é‚£æˆ‘ä»¬éƒ½çŸ¥é“ HTTP, é‚£è¿™ä¸ª S åˆ°åº•æ˜¯ä¸ªä»€ä¹ˆç©æ„å‘¢? æ²¡é”™,è¿™é‡ŒæŒ‡çš„æ˜¯ SSL/TLS ä¸€ç§åŠ å¯†æŠ€æœ¯.åŸç†å¾ˆå¤æ‚,ä¹Ÿå¾ˆæ¯ç‡¥.ä»¥è‡³äºå¹³å¸¸å¾ˆå°‘å»åˆ¨æ ¹é—®åº•çš„å­¦ä¹ ä»–,ä»Šå¤©æˆ‘è¯•ç€ä»¥å­¦ä¹ çš„æ–¹å¼å»æ•´ç†å’Œç†è§£ SSL/TLS ä»è€Œææ¸… HTPPS åšäº†ä»€ä¹ˆäº‹.ä¸‹è¾¹è¿™å¼ å›¾è¡¨ç¤ºäº† SSL/TLS ä»‹äºTCPä¹‹é—´çš„ä½ç½®.(*å›¾æ¥è‡ªç½‘ç»œ,ä¾µåˆ *)
![](https://ws1.sinaimg.cn/large/006tKfTcly1fiq97tkzqyj30il09zdhd.jpg)

#### æ•´ä½“ç»“æ„
- **SSLï¼š**ï¼ˆSecure Socket Layerï¼Œå®‰å…¨å¥—æ¥å­—å±‚ï¼‰ï¼Œä¸ºNetscapeæ‰€ç ”å‘ï¼Œç”¨ä»¥ä¿éšœåœ¨Internetä¸Šæ•°æ®ä¼ è¾“ä¹‹å®‰å…¨ï¼Œåˆ©ç”¨æ•°æ®åŠ å¯†(Encryption)æŠ€æœ¯ï¼Œå¯ç¡®ä¿æ•°æ®åœ¨ç½‘ç»œä¸Šä¹‹ä¼ è¾“è¿‡ç¨‹ä¸­ä¸ä¼šè¢«æˆªå–ã€‚å½“å‰ç‰ˆæœ¬ä¸º3.0ã€‚å®ƒå·²è¢«å¹¿æ³›åœ°ç”¨äºWebæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„èº«ä»½è®¤è¯å’ŒåŠ å¯†æ•°æ®ä¼ è¾“ã€‚
SSLåè®®ä½äºTCP/IPåè®®ä¸å„ç§åº”ç”¨å±‚åè®®ä¹‹é—´ï¼Œä¸ºæ•°æ®é€šè®¯æä¾›å®‰å…¨æ”¯æŒã€‚SSLåè®®å¯åˆ†ä¸ºä¸¤å±‚ï¼š SSLè®°å½•åè®®ï¼ˆSSL Record Protocolï¼‰ï¼šå®ƒå»ºç«‹åœ¨å¯é çš„ä¼ è¾“åè®®ï¼ˆå¦‚TCPï¼‰ä¹‹ä¸Šï¼Œä¸ºé«˜å±‚åè®®æä¾›æ•°æ®å°è£…ã€å‹ç¼©ã€åŠ å¯†ç­‰åŸºæœ¬åŠŸèƒ½çš„æ”¯æŒã€‚ SSLæ¡æ‰‹åè®®ï¼ˆSSL Handshake Protocolï¼‰ï¼šå®ƒå»ºç«‹åœ¨SSLè®°å½•åè®®ä¹‹ä¸Šï¼Œç”¨äºåœ¨å®é™…çš„æ•°æ®ä¼ è¾“å¼€å§‹å‰ï¼Œé€šè®¯åŒæ–¹è¿›è¡Œèº«ä»½è®¤è¯ã€åå•†åŠ å¯†ç®—æ³•ã€äº¤æ¢åŠ å¯†å¯†é’¥ç­‰ã€‚
- **TLSï¼š**(Transport Layer Securityï¼Œä¼ è¾“å±‚å®‰å…¨åè®®)ï¼Œç”¨äºä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¿å¯†æ€§å’Œæ•°æ®å®Œæ•´æ€§ã€‚
TLS 1.0æ˜¯IETFï¼ˆInternet Engineering Task Forceï¼ŒInternetå·¥ç¨‹ä»»åŠ¡ç»„ï¼‰åˆ¶å®šçš„ä¸€ç§æ–°çš„åè®®ï¼Œå®ƒå»ºç«‹åœ¨SSL 3.0åè®®è§„èŒƒä¹‹ä¸Šï¼Œæ˜¯SSL 3.0çš„åç»­ç‰ˆæœ¬ï¼Œå¯ä»¥ç†è§£ä¸ºSSL 3.1ï¼Œå®ƒæ˜¯å†™å…¥äº† RFC çš„ã€‚è¯¥åè®®ç”±ä¸¤å±‚ç»„æˆï¼š TLS è®°å½•åè®®ï¼ˆTLS Recordï¼‰å’Œ TLS æ¡æ‰‹åè®®ï¼ˆTLS Handshakeï¼‰ã€‚è¾ƒä½çš„å±‚ä¸º TLS è®°å½•åè®®ï¼Œä½äºæŸä¸ªå¯é çš„ä¼ è¾“åè®®ï¼ˆä¾‹å¦‚ TCPï¼‰ä¸Šé¢ã€‚

SSL/TLS ä¸»è¦æä¾›:

1. è®¤è¯ç”¨æˆ·å’ŒæœåŠ¡å™¨ï¼Œç¡®ä¿æ•°æ®å‘é€åˆ°æ­£ç¡®çš„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ï¼›
2. åŠ å¯†æ•°æ®ä»¥é˜²æ­¢æ•°æ®ä¸­é€”è¢«çªƒå–ï¼›
3. ç»´æŠ¤æ•°æ®çš„å®Œæ•´æ€§ï¼Œç¡®ä¿æ•°æ®åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸è¢«æ”¹å˜ã€‚

#### å¯†é’¥åå•†è¿‡ç¨‹ - TLSæ¡æ‰‹
SSLåè®®åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šHandshake Protocolå’ŒRecord Protocolã€‚å…¶ä¸­Handshake Protocolç”¨æ¥åå•†å¯†é’¥ï¼Œåè®®çš„å¤§éƒ¨åˆ†å†…å®¹å°±æ˜¯é€šä¿¡åŒæ–¹å¦‚ä½•åˆ©ç”¨å®ƒæ¥å®‰å…¨çš„åå•†å‡ºä¸€ä»½å¯†é’¥ã€‚ä¹Ÿæ˜¯æ˜¯ A å’Œ B è¦è¿›è¡Œå¯¹è¯çš„å¯†è¯­æ˜¯ä»€ä¹ˆ. Record Protocolåˆ™å®šä¹‰äº†ä¼ è¾“çš„æ ¼å¼ã€‚

ç”±äºéå¯¹ç§°åŠ å¯†çš„é€Ÿåº¦æ¯”è¾ƒæ…¢ï¼Œæ‰€ä»¥å®ƒä¸€èˆ¬ç”¨äºå¯†é’¥äº¤æ¢ï¼ŒåŒæ–¹é€šè¿‡å…¬é’¥ç®—æ³•åå•†å‡ºä¸€ä»½å¯†é’¥ï¼Œç„¶åé€šè¿‡å¯¹ç§°åŠ å¯†æ¥é€šä¿¡ï¼Œå½“ç„¶ï¼Œä¸ºäº†ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œåœ¨åŠ å¯†å‰è¦å…ˆç»è¿‡HMACçš„å¤„ç†ã€‚

ä»¥ä¸‹æ˜¯å…¶æµç¨‹å›¾ï¼ˆæ‘˜è‡ªTLSåè®®ï¼‰ã€‚
![](https://ws3.sinaimg.cn/large/006tKfTcly1fiqa8pszgmj315s0sogpa.jpg)

#### å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚
ç”±äºå®¢æˆ·ç«¯(å¦‚æµè§ˆå™¨)å¯¹ä¸€äº›åŠ è§£å¯†ç®—æ³•çš„æ”¯æŒç¨‹åº¦ä¸ä¸€æ ·ï¼Œä½†æ˜¯åœ¨TLSåè®®ä¼ è¾“è¿‡ç¨‹ä¸­å¿…é¡»ä½¿ç”¨åŒä¸€å¥—åŠ è§£å¯†ç®—æ³•æ‰èƒ½ä¿è¯æ•°æ®èƒ½å¤Ÿæ­£å¸¸çš„åŠ è§£å¯†ã€‚åœ¨TLSæ¡æ‰‹é˜¶æ®µï¼Œå®¢æˆ·ç«¯é¦–å…ˆè¦å‘ŠçŸ¥æœåŠ¡ç«¯ï¼Œè‡ªå·±æ”¯æŒå“ªäº›åŠ å¯†ç®—æ³•ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯éœ€è¦å°†æœ¬åœ°æ”¯æŒçš„åŠ å¯†å¥—ä»¶(Cipher Suite)çš„åˆ—è¡¨ä¼ é€ç»™æœåŠ¡ç«¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®¢æˆ·ç«¯è¿˜è¦äº§ç”Ÿä¸€ä¸ªéšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°ä¸€æ–¹é¢éœ€è¦åœ¨å®¢æˆ·ç«¯ä¿å­˜ï¼Œå¦ä¸€æ–¹é¢éœ€è¦ä¼ é€ç»™æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯çš„éšæœºæ•°éœ€è¦è·ŸæœåŠ¡ç«¯äº§ç”Ÿçš„éšæœºæ•°ç»“åˆèµ·æ¥äº§ç”Ÿåé¢è¦è®²åˆ°çš„ Master Secret ã€‚
ç»¼ä¸Šï¼Œåœ¨è¿™ä¸€æ­¥ï¼Œå®¢æˆ·ç«¯ä¸»è¦å‘æœåŠ¡å™¨æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. æ”¯æŒçš„åè®®ç‰ˆæœ¬ï¼Œæ¯”å¦‚TLS 1.0ç‰ˆ
2. ä¸€ä¸ªå®¢æˆ·ç«¯ç”Ÿæˆçš„éšæœºæ•°ï¼Œç¨åç”¨äºç”Ÿæˆ"å¯¹è¯å¯†é’¥"
3. æ”¯æŒçš„åŠ å¯†æ–¹æ³•ï¼Œæ¯”å¦‚RSAå…¬é’¥åŠ å¯†
4. æ”¯æŒçš„å‹ç¼©æ–¹æ³•

#### æœåŠ¡å™¨å›åº”
ä¸Šå›¾ä¸­ï¼Œä»Server Helloåˆ°Server Doneï¼Œæœ‰äº›æœåŠ¡ç«¯çš„å®ç°æ˜¯æ¯æ¡å•ç‹¬å‘é€ï¼Œæœ‰æœåŠ¡ç«¯å®ç°æ˜¯åˆå¹¶åˆ°ä¸€èµ·å‘é€ã€‚Sever Helloå’ŒServer Doneéƒ½æ˜¯åªæœ‰å¤´æ²¡æœ‰å†…å®¹çš„æ•°æ®ã€‚

æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„Client Helloä¹‹åï¼ŒæœåŠ¡ç«¯éœ€è¦å°†è‡ªå·±çš„è¯ä¹¦å‘é€ç»™å®¢æˆ·ç«¯ã€‚è¿™ä¸ªè¯ä¹¦æ˜¯å¯¹äºæœåŠ¡ç«¯çš„ä¸€ç§è®¤è¯ã€‚ä¾‹å¦‚ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°äº†ä¸€ä¸ªæ¥è‡ªäºç§°è‡ªå·±æ˜¯www.alipay.comçš„æ•°æ®ï¼Œä½†æ˜¯å¦‚ä½•è¯æ˜å¯¹æ–¹æ˜¯åˆæ³•çš„alipayæ”¯ä»˜å®å‘¢ï¼Ÿè¿™å°±æ˜¯è¯ä¹¦çš„ä½œç”¨ï¼Œæ”¯ä»˜å®çš„è¯ä¹¦å¯ä»¥è¯æ˜å®ƒæ˜¯alipayï¼Œè€Œä¸æ˜¯è´¢ä»˜é€šã€‚è¯ä¹¦æ˜¯éœ€è¦ç”³è¯·ï¼Œå¹¶ç”±ä¸“é—¨çš„æ•°å­—è¯ä¹¦è®¤è¯æœºæ„(CA)é€šè¿‡éå¸¸ä¸¥æ ¼çš„å®¡æ ¸ä¹‹åé¢å‘çš„ç”µå­è¯ä¹¦ã€‚é¢å‘è¯ä¹¦çš„åŒæ—¶ä¼šäº§ç”Ÿä¸€ä¸ªç§é’¥å’Œå…¬é’¥ã€‚ç§é’¥ç”±æœåŠ¡ç«¯è‡ªå·±ä¿å­˜ï¼Œä¸å¯æ³„æ¼ã€‚å…¬é’¥åˆ™æ˜¯é™„å¸¦åœ¨è¯ä¹¦çš„ä¿¡æ¯ä¸­ï¼Œå¯ä»¥å…¬å¼€çš„ã€‚è¯ä¹¦æœ¬èº«ä¹Ÿé™„å¸¦ä¸€ä¸ªè¯ä¹¦ç”µå­ç­¾åï¼Œè¿™ä¸ªç­¾åç”¨æ¥éªŒè¯è¯ä¹¦çš„å®Œæ•´æ€§å’ŒçœŸå®æ€§ï¼Œå¯ä»¥é˜²æ­¢è¯ä¹¦è¢«ä¸²æ”¹ã€‚å¦å¤–ï¼Œè¯ä¹¦è¿˜æœ‰ä¸ªæœ‰æ•ˆæœŸã€‚

åœ¨æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯å‘é€çš„è¯ä¹¦ä¸­æ²¡æœ‰æä¾›è¶³å¤Ÿçš„ä¿¡æ¯ï¼ˆè¯ä¹¦å…¬é’¥ï¼‰çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥å‘å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª Server Key Exchangeï¼Œ

æ­¤å¤–ï¼Œå¯¹äºéå¸¸é‡è¦çš„ä¿å¯†æ•°æ®ï¼ŒæœåŠ¡ç«¯è¿˜éœ€è¦å¯¹å®¢æˆ·ç«¯è¿›è¡ŒéªŒè¯ï¼Œä»¥ä¿è¯æ•°æ®ä¼ é€ç»™äº†å®‰å…¨çš„åˆæ³•çš„å®¢æˆ·ç«¯ã€‚æœåŠ¡ç«¯å¯ä»¥å‘å®¢æˆ·ç«¯å‘å‡º Cerficate Request æ¶ˆæ¯ï¼Œè¦æ±‚å®¢æˆ·ç«¯å‘é€è¯ä¹¦å¯¹å®¢æˆ·ç«¯çš„åˆæ³•æ€§è¿›è¡ŒéªŒè¯ã€‚æ¯”å¦‚ï¼Œé‡‘èæœºæ„å¾€å¾€åªå…è®¸è®¤è¯å®¢æˆ·è¿å…¥è‡ªå·±çš„ç½‘ç»œï¼Œå°±ä¼šå‘æ­£å¼å®¢æˆ·æä¾›USBå¯†é’¥ï¼Œé‡Œé¢å°±åŒ…å«äº†ä¸€å¼ å®¢æˆ·ç«¯è¯ä¹¦ã€‚

è·Ÿå®¢æˆ·ç«¯ä¸€æ ·ï¼ŒæœåŠ¡ç«¯ä¹Ÿéœ€è¦äº§ç”Ÿä¸€ä¸ªéšæœºæ•°å‘é€ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½éœ€è¦ä½¿ç”¨è¿™ä¸¤ä¸ªéšæœºæ•°æ¥äº§ç”ŸMaster Secretã€‚

æœ€åæœåŠ¡ç«¯ä¼šå‘é€ä¸€ä¸ªServer Hello Doneæ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œè¡¨ç¤ºServer Helloæ¶ˆæ¯ç»“æŸäº†ã€‚

ç»¼ä¸Šï¼Œåœ¨è¿™ä¸€æ­¥ï¼ŒæœåŠ¡å™¨çš„å›åº”åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

1. ç¡®è®¤ä½¿ç”¨çš„åŠ å¯†é€šä¿¡åè®®ç‰ˆæœ¬ï¼Œæ¯”å¦‚TLS 1.0ç‰ˆæœ¬ã€‚å¦‚æœæµè§ˆå™¨ä¸æœåŠ¡å™¨æ”¯æŒçš„ç‰ˆæœ¬ä¸ä¸€è‡´ï¼ŒæœåŠ¡å™¨å…³é—­åŠ å¯†é€šä¿¡
2. ä¸€ä¸ªæœåŠ¡å™¨ç”Ÿæˆçš„éšæœºæ•°ï¼Œç¨åç”¨äºç”Ÿæˆ"å¯¹è¯å¯†é’¥"
3. ç¡®è®¤ä½¿ç”¨çš„åŠ å¯†æ–¹æ³•ï¼Œæ¯”å¦‚RSAå…¬é’¥åŠ å¯†
4. æœåŠ¡å™¨è¯ä¹¦

#### å®¢æˆ·ç«¯å›åº”
Client Key Exchange

å¦‚æœæœåŠ¡ç«¯éœ€è¦å¯¹å®¢æˆ·ç«¯è¿›è¡ŒéªŒè¯ï¼Œåœ¨å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ Server Hello æ¶ˆæ¯ä¹‹åï¼Œé¦–å…ˆéœ€è¦å‘æœåŠ¡ç«¯å‘é€å®¢æˆ·ç«¯çš„è¯ä¹¦ï¼Œè®©æœåŠ¡ç«¯æ¥éªŒè¯å®¢æˆ·ç«¯çš„åˆæ³•æ€§ã€‚

Certificate Verify
æ¥ç€ï¼Œå®¢æˆ·ç«¯éœ€è¦å¯¹æœåŠ¡ç«¯çš„è¯ä¹¦è¿›è¡Œæ£€æŸ¥ï¼Œå¦‚æœè¯ä¹¦ä¸æ˜¯å¯ä¿¡æœºæ„é¢å¸ƒã€æˆ–è€…è¯ä¹¦ä¸­çš„åŸŸåä¸å®é™…åŸŸåä¸ä¸€è‡´ã€æˆ–è€…è¯ä¹¦å·²ç»è¿‡æœŸï¼Œå°±ä¼šå‘è®¿é—®è€…æ˜¾ç¤ºä¸€ä¸ªè­¦å‘Šï¼Œç”±å…¶é€‰æ‹©æ˜¯å¦è¿˜è¦ç»§ç»­é€šä¿¡ã€‚å¦‚æœè¯ä¹¦æ²¡æœ‰é—®é¢˜ï¼Œå®¢æˆ·ç«¯å°±ä¼šä»æœåŠ¡å™¨è¯ä¹¦ä¸­å–å‡ºæœåŠ¡å™¨çš„å…¬é’¥ã€‚ç„¶åï¼Œå‘æœåŠ¡å™¨å‘é€ä¸‹é¢ä¸‰é¡¹ä¿¡æ¯ï¼š

1. ä¸€ä¸ªéšæœºæ•°ã€‚è¯¥éšæœºæ•°ç”¨æœåŠ¡å™¨å…¬é’¥åŠ å¯†ï¼Œé˜²æ­¢è¢«çªƒå¬
2. ç¼–ç æ”¹å˜é€šçŸ¥ï¼Œè¡¨ç¤ºéšåçš„ä¿¡æ¯éƒ½å°†ç”¨åŒæ–¹å•†å®šçš„åŠ å¯†æ–¹æ³•å’Œå¯†é’¥å‘é€
3. å®¢æˆ·ç«¯æ¡æ‰‹ç»“æŸé€šçŸ¥ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯çš„æ¡æ‰‹é˜¶æ®µå·²ç»ç»“æŸã€‚è¿™ä¸€é¡¹åŒæ—¶ä¹Ÿæ˜¯å‰é¢å‘é€çš„æ‰€æœ‰å†…å®¹çš„hashå€¼ï¼Œç”¨æ¥ä¾›æœåŠ¡å™¨æ ¡éªŒ

ä¸Šé¢ç¬¬ä¸€é¡¹çš„éšæœºæ•°ï¼Œæ˜¯æ•´ä¸ªæ¡æ‰‹é˜¶æ®µå‡ºç°çš„ç¬¬ä¸‰ä¸ªéšæœºæ•°ï¼Œå®ƒæ˜¯å®¢æˆ·ç«¯ä½¿ç”¨ä¸€äº›åŠ å¯†ç®—æ³•(ä¾‹å¦‚ï¼šRSA, Diffie-Hellman)äº§ç”Ÿä¸€ä¸ª48ä¸ªå­—èŠ‚çš„Keyï¼Œè¿™ä¸ªKeyå« PreMaster Secretï¼Œå¾ˆå¤šææ–™ä¸Šä¹Ÿè¢«ç§°ä½œ PreMaster Keyã€‚
ChangeCipherSpec
ChangeCipherSpecæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åè®®ï¼Œä½“ç°åœ¨æ•°æ®åŒ…ä¸­å°±æ˜¯ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œç”¨äºå‘ŠçŸ¥æœåŠ¡ç«¯ï¼Œå®¢æˆ·ç«¯å·²ç»åˆ‡æ¢åˆ°ä¹‹å‰åå•†å¥½çš„åŠ å¯†å¥—ä»¶ï¼ˆCipher Suiteï¼‰çš„çŠ¶æ€ï¼Œå‡†å¤‡ä½¿ç”¨ä¹‹å‰åå•†å¥½çš„åŠ å¯†å¥—ä»¶åŠ å¯†æ•°æ®å¹¶ä¼ è¾“äº†ã€‚

åœ¨ChangecipherSpecä¼ è¾“å®Œæ¯•ä¹‹åï¼Œå®¢æˆ·ç«¯ä¼šä½¿ç”¨ä¹‹å‰åå•†å¥½çš„åŠ å¯†å¥—ä»¶å’ŒSession SecretåŠ å¯†ä¸€æ®µ Finish çš„æ•°æ®ä¼ é€ç»™æœåŠ¡ç«¯ï¼Œæ­¤æ•°æ®æ˜¯ä¸ºäº†åœ¨æ­£å¼ä¼ è¾“åº”ç”¨æ•°æ®ä¹‹å‰å¯¹åˆšåˆšæ¡æ‰‹å»ºç«‹èµ·æ¥çš„åŠ è§£å¯†é€šé“è¿›è¡ŒéªŒè¯ã€‚

#### æœåŠ¡å™¨çš„æœ€åå›åº”
æœåŠ¡ç«¯åœ¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„ PreMaster åŠ å¯†æ•°æ®ä¹‹åï¼Œä½¿ç”¨ç§é’¥å¯¹è¿™æ®µåŠ å¯†æ•°æ®è¿›è¡Œè§£å¯†ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œä¹Ÿä¼šä½¿ç”¨è·Ÿå®¢æˆ·ç«¯åŒæ ·çš„æ–¹å¼ç”Ÿæˆ Session Secretï¼Œä¸€åˆ‡å‡†å¤‡å¥½ä¹‹åï¼Œä¼šç»™å®¢æˆ·ç«¯å‘é€ä¸€ä¸ª ChangeCipherSpecï¼Œå‘ŠçŸ¥å®¢æˆ·ç«¯å·²ç»åˆ‡æ¢åˆ°åå•†è¿‡çš„åŠ å¯†å¥—ä»¶çŠ¶æ€ï¼Œå‡†å¤‡ä½¿ç”¨åŠ å¯†å¥—ä»¶å’Œ Session SecretåŠ å¯†æ•°æ®äº†ã€‚ä¹‹åï¼ŒæœåŠ¡ç«¯ä¹Ÿä¼šä½¿ç”¨ Session Secret åŠ å¯†ä¸€æ®µ Finish æ¶ˆæ¯å‘é€ç»™å®¢æˆ·ç«¯ï¼Œä»¥éªŒè¯ä¹‹å‰é€šè¿‡æ¡æ‰‹å»ºç«‹èµ·æ¥çš„åŠ è§£å¯†é€šé“æ˜¯å¦æˆåŠŸã€‚

æ ¹æ®ä¹‹å‰çš„æ¡æ‰‹ä¿¡æ¯ï¼Œå¦‚æœå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½èƒ½å¯¹Finishä¿¡æ¯è¿›è¡Œæ­£å¸¸åŠ è§£å¯†ä¸”æ¶ˆæ¯æ­£ç¡®çš„è¢«éªŒè¯ï¼Œåˆ™è¯´æ˜æ¡æ‰‹é€šé“å·²ç»å»ºç«‹æˆåŠŸï¼Œæ¥ä¸‹æ¥ï¼ŒåŒæ–¹å¯ä»¥ä½¿ç”¨ä¸Šé¢äº§ç”Ÿçš„Session Secretå¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ä¼ è¾“äº†ã€‚

ä»¥ä¸Šä¸»è¦æ˜¯æ•´ç†è¿™ä¸ªæ¡æ‰‹ğŸ¤çš„è¿‡ç¨‹.ä½†å…¶ä¸­çš„Secret Keys ç­‰æ²¡æœ‰è¯¦ç»†è¯´æ˜,æ¥ä¸‹æ¥çœ‹è¿™äº›Secret Keys çš„ç”Ÿæˆè¿‡ç¨‹åŠä½œç”¨.
![](https://ws2.sinaimg.cn/large/006tKfTcly1fiqcjuiif7j30bj0cwq3l.jpg)

**PreMaster secret**

PreMaster Secretæ˜¯åœ¨å®¢æˆ·ç«¯ä½¿ç”¨RSAæˆ–è€…Diffie-Hellmanç­‰åŠ å¯†ç®—æ³•ç”Ÿæˆçš„ã€‚å®ƒå°†ç”¨æ¥è·ŸæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯åœ¨Helloé˜¶æ®µäº§ç”Ÿçš„éšæœºæ•°ç»“åˆåœ¨ä¸€èµ·ç”Ÿæˆ Master Secretã€‚åœ¨å®¢æˆ·ç«¯ä½¿ç”¨æœåŠ¡ç«¯çš„å…¬é’¥å¯¹PreMaster Secretè¿›è¡ŒåŠ å¯†ä¹‹åä¼ é€ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯å°†ä½¿ç”¨ç§é’¥è¿›è¡Œè§£å¯†å¾—åˆ°PreMaster secretã€‚ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½æœ‰ä¸€ä»½ç›¸åŒçš„PreMaster secretå’Œéšæœºæ•°ã€‚

PreMaster secretå‰ä¸¤ä¸ªå­—èŠ‚æ˜¯TLSçš„ç‰ˆæœ¬å·ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„ç”¨æ¥æ ¸å¯¹æ¡æ‰‹æ•°æ®çš„ç‰ˆæœ¬å·ï¼Œå› ä¸ºåœ¨Client Helloé˜¶æ®µï¼Œå®¢æˆ·ç«¯ä¼šå‘é€ä¸€ä»½åŠ å¯†å¥—ä»¶åˆ—è¡¨å’Œå½“å‰æ”¯æŒçš„SSL/TLSçš„ç‰ˆæœ¬å·ç»™æœåŠ¡ç«¯ï¼Œè€Œä¸”æ˜¯ä½¿ç”¨æ˜æ–‡ä¼ é€çš„ï¼Œå¦‚æœæ¡æ‰‹çš„æ•°æ®åŒ…è¢«ç ´è§£ä¹‹åï¼Œæ”»å‡»è€…å¾ˆæœ‰å¯èƒ½ä¸²æ”¹æ•°æ®åŒ…ï¼Œé€‰æ‹©ä¸€ä¸ªå®‰å…¨æ€§è¾ƒä½çš„åŠ å¯†å¥—ä»¶å’Œç‰ˆæœ¬ç»™æœåŠ¡ç«¯ï¼Œä»è€Œå¯¹æ•°æ®è¿›è¡Œç ´è§£ã€‚æ‰€ä»¥ï¼ŒæœåŠ¡ç«¯éœ€è¦å¯¹å¯†æ–‡ä¸­è§£å¯†å‡ºæ¥å¯¹çš„PreMasterç‰ˆæœ¬å·è·Ÿä¹‹å‰Client Helloé˜¶æ®µçš„ç‰ˆæœ¬å·è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç‰ˆæœ¬å·å˜ä½ï¼Œåˆ™è¯´æ˜è¢«ä¸²æ”¹ï¼Œåˆ™ç«‹å³åœæ­¢å‘é€ä»»ä½•æ¶ˆæ¯ã€‚

**Master secret**

ä¸Šé¢å·²ç»æåˆ°ï¼Œç”±äºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯éƒ½æœ‰ä¸€ä»½ç›¸åŒçš„PreMaster secretå’Œéšæœºæ•°ï¼Œè¿™ä¸ªéšæœºæ•°å°†ä½œä¸ºåé¢äº§ç”ŸMaster secretçš„ç§å­ï¼Œç»“åˆPreMaster secretï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å°†è®¡ç®—å‡ºåŒæ ·çš„Master secretã€‚

Master secretæ˜¯æœ‰ç³»åˆ—çš„hashå€¼ç»„æˆçš„ï¼Œå®ƒå°†ä½œä¸ºæ•°æ®åŠ è§£å¯†ç›¸å…³çš„secretçš„ Key Material çš„ä¸€éƒ¨åˆ†ã€‚Key Materialæœ€ç»ˆè§£æå‡ºæ¥çš„æ•°æ®å¦‚ä¸‹ï¼š
![](https://ws1.sinaimg.cn/large/006tKfTcly1fiqcmzns9dj306i07iaaa.jpg)

#### åº”ç”¨æ•°æ®ä¼ è¾“
åœ¨æ‰€æœ‰çš„æ¡æ‰‹é˜¶æ®µéƒ½å®Œæˆä¹‹åï¼Œå°±å¯ä»¥å¼€å§‹ä¼ é€åº”ç”¨æ•°æ®äº†ã€‚åº”ç”¨æ•°æ®åœ¨ä¼ è¾“ä¹‹å‰ï¼Œé¦–å…ˆè¦é™„åŠ ä¸ŠMAC secretï¼Œç„¶åå†å¯¹è¿™ä¸ªæ•°æ®åŒ…ä½¿ç”¨write encryption keyè¿›è¡ŒåŠ å¯†ã€‚åœ¨æœåŠ¡ç«¯æ”¶åˆ°å¯†æ–‡ä¹‹åï¼Œä½¿ç”¨Client write encryption keyè¿›è¡Œè§£å¯†ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„æ•°æ®ä¹‹åä½¿ç”¨Server write encryption keyè¿›è¡Œè§£å¯†ï¼Œç„¶åä½¿ç”¨å„è‡ªçš„write MAC keyå¯¹æ•°æ®çš„å®Œæ•´æ€§åŒ…æ‹¬æ˜¯å¦è¢«ä¸²æ”¹è¿›è¡ŒéªŒè¯ã€‚

#### æ€»ç»“
SSLå®¢æˆ·ç«¯ï¼ˆä¹Ÿæ˜¯TCPçš„å®¢æˆ·ç«¯ï¼‰åœ¨TCPé“¾æ¥å»ºç«‹ä¹‹åï¼Œå‘å‡ºä¸€ä¸ªClientHelloæ¥å‘èµ·æ¡æ‰‹ï¼Œè¿™ä¸ªæ¶ˆæ¯é‡Œé¢åŒ…å«äº†è‡ªå·±å¯å®ç°çš„ç®—æ³•åˆ—è¡¨å’Œå…¶å®ƒä¸€äº›éœ€è¦çš„æ¶ˆæ¯ï¼ŒSSLçš„æœåŠ¡å™¨ç«¯ä¼šå›åº”ä¸€ä¸ªServerHelloï¼Œè¿™é‡Œé¢ç¡®å®šäº†è¿™æ¬¡é€šä¿¡æ‰€éœ€è¦çš„ç®—æ³•ï¼Œç„¶åå‘è¿‡å»è‡ªå·±çš„è¯ä¹¦ï¼ˆé‡Œé¢åŒ…å«äº†èº«ä»½å’Œè‡ªå·±çš„å…¬é’¥ï¼‰ã€‚Clientåœ¨æ”¶åˆ°è¿™ä¸ªæ¶ˆæ¯åä¼šç”Ÿæˆä¸€ä¸ªç§˜å¯†æ¶ˆæ¯ï¼Œç”¨SSLæœåŠ¡å™¨çš„å…¬é’¥åŠ å¯†åä¼ è¿‡å»ï¼ŒSSLæœåŠ¡å™¨ç«¯ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†åï¼Œä¼šè¯å¯†é’¥åå•†æˆåŠŸï¼ŒåŒæ–¹å¯ä»¥ç”¨åŒä¸€ä»½ä¼šè¯å¯†é’¥æ¥é€šä¿¡äº†ã€‚

#### å¯†é’¥åå•†çš„å½¢è±¡åŒ–æ¯”å–»
å¦‚æœä¸Šé¢çš„è¯´æ˜ä¸å¤Ÿæ¸…æ™°ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸ªå½¢è±¡çš„æ¯”å–»ï¼Œæˆ‘ä»¬å‡è®¾Aä¸Bé€šä¿¡ï¼ŒAæ˜¯SSLå®¢æˆ·ç«¯ï¼ŒBæ˜¯SSLæœåŠ¡å™¨ç«¯ï¼ŒåŠ å¯†åçš„æ¶ˆæ¯æ”¾åœ¨æ–¹æ‹¬å·[]é‡Œï¼Œä»¥çªå‡ºæ˜æ–‡æ¶ˆæ¯çš„åŒºåˆ«ã€‚åŒæ–¹çš„å¤„ç†åŠ¨ä½œçš„è¯´æ˜ç”¨åœ†æ‹¬å·ï¼ˆï¼‰æ‹¬èµ·ã€‚

Aï¼šæˆ‘æƒ³å’Œä½ å®‰å…¨çš„é€šè¯ï¼Œæˆ‘è¿™é‡Œçš„å¯¹ç§°åŠ å¯†ç®—æ³•æœ‰DES,RC5,å¯†é’¥äº¤æ¢ç®—æ³•æœ‰RSAå’ŒDHï¼Œæ‘˜è¦ç®—æ³•æœ‰MD5å’ŒSHAã€‚

Bï¼šæˆ‘ä»¬ç”¨DESï¼RSAï¼SHAè¿™å¯¹ç»„åˆå¥½äº†ã€‚
è¿™æ˜¯æˆ‘çš„è¯ä¹¦ï¼Œé‡Œé¢æœ‰æˆ‘çš„åå­—å’Œå…¬é’¥ï¼Œä½ æ‹¿å»éªŒè¯ä¸€ä¸‹æˆ‘çš„èº«ä»½ï¼ˆæŠŠè¯ä¹¦å‘ç»™Aï¼‰ã€‚
ç›®å‰æ²¡æœ‰åˆ«çš„å¯è¯´çš„äº†ã€‚

Aï¼šï¼ˆæŸ¥çœ‹è¯ä¹¦ä¸ŠBçš„åå­—æ˜¯å¦æ— è¯¯ï¼Œå¹¶é€šè¿‡æ‰‹å¤´æ—©å·²æœ‰çš„CAçš„è¯ä¹¦éªŒè¯äº†Bçš„è¯ä¹¦çš„çœŸå®æ€§ï¼Œå¦‚æœå…¶ä¸­ä¸€é¡¹æœ‰è¯¯ï¼Œå‘å‡ºè­¦å‘Šå¹¶æ–­å¼€è¿æ¥ï¼Œè¿™ä¸€æ­¥ä¿è¯äº†Bçš„å…¬é’¥çš„çœŸå®æ€§ï¼‰
ï¼ˆäº§ç”Ÿä¸€ä»½ç§˜å¯†æ¶ˆæ¯ï¼Œè¿™ä»½ç§˜å¯†æ¶ˆæ¯å¤„ç†åå°†ç”¨ä½œåŠ å¯†å¯†é’¥ï¼ŒåŠ å¯†åˆå§‹åŒ–å‘é‡ï¼ˆIVï¼‰å’Œhmacçš„å¯†é’¥ã€‚å°†è¿™ä»½ç§˜å¯†æ¶ˆæ¯-åè®®ä¸­ç§°ä¸ºper_master_secret-ç”¨Bçš„å…¬é’¥åŠ å¯†ï¼Œå°è£…æˆç§°ä½œClientKeyExchangeçš„æ¶ˆæ¯ã€‚ç”±äºç”¨äº†Bçš„å…¬é’¥ï¼Œä¿è¯äº†ç¬¬ä¸‰æ–¹æ— æ³•çªƒå¬ï¼‰
æˆ‘ç”Ÿæˆäº†ä¸€ä»½ç§˜å¯†æ¶ˆæ¯ï¼Œå¹¶ç”¨ä½ çš„å…¬é’¥åŠ å¯†äº†ï¼Œç»™ä½ ï¼ˆæŠŠClientKeyExchangeå‘ç»™Bï¼‰
æ³¨æ„ï¼Œä¸‹é¢æˆ‘å°±è¦ç”¨åŠ å¯†çš„åŠæ³•ç»™ä½ å‘æ¶ˆæ¯äº†ï¼
ï¼ˆå°†ç§˜å¯†æ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼Œç”ŸæˆåŠ å¯†å¯†é’¥ï¼ŒåŠ å¯†åˆå§‹åŒ–å‘é‡å’Œhmacçš„å¯†é’¥ï¼‰
[æˆ‘è¯´å®Œäº†]

Bï¼šï¼ˆç”¨è‡ªå·±çš„ç§é’¥å°†ClientKeyExchangeä¸­çš„ç§˜å¯†æ¶ˆæ¯è§£å¯†å‡ºæ¥ï¼Œç„¶åå°†ç§˜å¯†æ¶ˆæ¯è¿›è¡Œå¤„ç†ï¼Œç”ŸæˆåŠ å¯†å¯†é’¥ï¼ŒåŠ å¯†åˆå§‹åŒ–å‘é‡å’Œhmacçš„å¯†é’¥ï¼Œè¿™æ—¶åŒæ–¹å·²ç»å®‰å…¨çš„åå•†å‡ºä¸€å¥—åŠ å¯†åŠæ³•äº†ï¼‰
æ³¨æ„ï¼Œæˆ‘ä¹Ÿè¦å¼€å§‹ç”¨åŠ å¯†çš„åŠæ³•ç»™ä½ å‘æ¶ˆæ¯äº†ï¼
[æˆ‘è¯´å®Œäº†]

A: [æˆ‘çš„ç§˜å¯†æ˜¯...]

B: [å…¶å®ƒäººä¸ä¼šå¬åˆ°çš„...]

#### SSLå®‰å…¨æ€§
SecurityPortalåœ¨2000å¹´åº•æœ‰ä¸€ä»½æ–‡ç« ã€ŠThe End of SSL and SSH?ã€‹æ¿€èµ·äº†å¾ˆå¤šçš„è®¨è®ºï¼Œ ç›®å‰ä¹Ÿæœ‰ä¸€äº›æˆç†Ÿçš„å·¥å…·å¦‚[dsniff](http://www.monkey.org/~dugsong/dsniff/)å¯ä»¥é€šè¿‡man in the middleæ”»å‡»æ¥æˆªè·httpsçš„æ¶ˆæ¯ã€‚

ä»ä¸Šé¢çš„åŸç†å¯çŸ¥ï¼ŒSSLçš„ç»“æ„æ˜¯ä¸¥è°¨çš„ï¼Œé—®é¢˜ä¸€èˆ¬å‡ºç°åœ¨å®é™…ä¸ä¸¥è°¨çš„åº”ç”¨ä¸­ã€‚å¸¸è§çš„æ”»å‡»å°±æ˜¯middle in the middleæ”»å‡»ï¼Œå®ƒæ˜¯æŒ‡åœ¨Aå’ŒBé€šä¿¡çš„åŒæ—¶ï¼Œæœ‰ç¬¬ä¸‰æ–¹Cå¤„äºä¿¡é“çš„ä¸­é—´ï¼Œå¯ä»¥å®Œå…¨å¬åˆ°Aä¸Bé€šä¿¡çš„æ¶ˆæ¯ï¼Œå¹¶å¯æ‹¦æˆªï¼Œæ›¿æ¢å’Œæ·»åŠ è¿™äº›æ¶ˆæ¯ã€‚

1. SSLå¯ä»¥å…è®¸å¤šç§å¯†é’¥äº¤æ¢ç®—æ³•ï¼Œè€Œæœ‰äº›ç®—æ³•ï¼Œå¦‚DHï¼Œæ²¡æœ‰è¯ä¹¦çš„æ¦‚å¿µï¼Œè¿™æ ·Aä¾¿æ— æ³•éªŒè¯Bçš„å…¬é’¥å’Œèº«ä»½çš„çœŸå®æ€§ï¼Œä»è€ŒCå¯ä»¥è½»æ˜“çš„å†’å……ï¼Œç”¨è‡ªå·±çš„å¯†é’¥ä¸åŒæ–¹é€šä¿¡ï¼Œä»è€Œçªƒå¬åˆ°åˆ«äººè°ˆè¯çš„å†…å®¹ã€‚
è€Œä¸ºäº†é˜²æ­¢middle in the middleæ”»å‡»ï¼Œåº”è¯¥é‡‡ç”¨æœ‰è¯ä¹¦çš„å¯†é’¥äº¤æ¢ç®—æ³•ã€‚
2. æœ‰äº†è¯ä¹¦ä»¥åï¼Œå¦‚æœCç”¨è‡ªå·±çš„è¯ä¹¦æ›¿æ¢æ‰åŸæœ‰çš„è¯ä¹¦ä¹‹åï¼ŒAçš„æµè§ˆå™¨ä¼šå¼¹å‡ºä¸€ä¸ªè­¦å‘Šæ¡†è¿›è¡Œè­¦å‘Šï¼Œä½†åˆæœ‰å¤šå°‘äººä¼šæ³¨æ„è¿™ä¸ªè­¦å‘Šå‘¢ï¼Ÿ
3. ç”±äºç¾å›½å¯†ç å‡ºå£çš„é™åˆ¶ï¼ŒIEï¼Œnetscapeç­‰æµè§ˆå™¨æ‰€æ”¯æŒçš„åŠ å¯†å¼ºåº¦æ˜¯å¾ˆå¼±çš„ï¼Œå¦‚æœåªé‡‡ç”¨æµè§ˆå™¨è‡ªå¸¦çš„åŠ å¯†åŠŸèƒ½çš„è¯ï¼Œç†è®ºä¸Šå­˜åœ¨è¢«ç ´è§£å¯èƒ½ã€‚

#### ä»£ç†
ä¸‹é¢æ¢è®¨ä¸€ä¸‹SSLçš„ä»£ç†æ˜¯æ€æ ·å·¥ä½œçš„
å½“åœ¨æµè§ˆå™¨é‡Œè®¾ç½®äº†httpsçš„ä»£ç†ï¼Œè€Œä¸”é‡Œè¾“å…¥äº†https://www.example.comä¹‹åï¼Œæµè§ˆå™¨ä¼šä¸proxyå»ºç«‹tcpé“¾æ¥ï¼Œç„¶åå‘å…¶å‘å‡ºè¿™ä¹ˆä¸€æ®µæ¶ˆæ¯ï¼š

	CONNECT server.example.com:443 HTTP/1.1
    Host: server.example.com:443

ç„¶åproxyä¼šå‘webserverç«¯å»ºç«‹tcpè¿æ¥,ä¹‹åï¼Œè¿™ä¸ªä»£ç†ä¾¿å®Œå…¨æˆäº†ä¸ªå†…å®¹è½¬å‘è£…ç½®ã€‚æµè§ˆå™¨ä¸web serverä¼šå»ºç«‹ä¸€ä¸ªå®‰å…¨é€šé“ï¼Œå› æ­¤è¿™ä¸ªå®‰å…¨é€šé“æ˜¯ç«¯åˆ°ç«¯çš„ï¼Œå°½ç®¡æ‰€æœ‰çš„ä¿¡æ¯æµè¿‡äº†proxy,ä½†å…¶å†…å®¹proxyæ˜¯æ— æ³•è§£å¯†å’Œæ”¹åŠ¨çš„ï¼ˆå½“ç„¶è¦ç”±è¯ä¹¦çš„æ”¯æŒï¼Œå¦åˆ™è¿™ä¸ªåœ°æ–¹ä¾¿æ˜¯ä¸ªman in the middleæ”»å‡»çš„å¥½åœºæ‰€ï¼Œè§ä¸Šé¢çš„å®‰å…¨éƒ¨åˆ†ï¼‰ã€‚

CAè¯ä¹¦ä»¥åŠå¦‚ä½•ä½¿ç”¨OpenSSLè‡ªç­¾ç½²ï¼Œè§æ–‡ç« [OpenSSLè‡ªç­¾ç½²è¯ä¹¦](http://seanlook.com/2015/01/15/openssl-self-sign-ca)

> å‚è€ƒ
> 
> - [Https(SSL/TLS)åŸç†è¯¦è§£](http://www.fenesky.com/blog/2014/07/19/how-https-works.html)
- [SSLä¸TLSçš„åŒºåˆ«ä»¥åŠä»‹ç»](http://kb.cnblogs.com/page/197396/)
- [SSL/TLSåè®®è¿è¡Œæœºåˆ¶çš„æ¦‚è¿°](http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html)
- [SSL/TLS/WTLSåŸç†](http://www.nsfocus.net/?act=magazine&amp;do=view&amp;mid=841)
- [Transport Layer Security (TLS)](http://tech.yanatm.com/?p=338)
- [ä¼ è¾“å±‚å®‰å…¨åè®®](http://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82%E5%AE%89%E5%85%A8%E5%8D%8F%E8%AE%AE)
- [Survival guides - TLS/SSL and SSL (X.509) Certificates](http://www.zytrax.com/tech/survival/ssl.html)